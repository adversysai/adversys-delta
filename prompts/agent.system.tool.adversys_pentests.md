# adversys_pentests Tool

> **CUSTOM ADDITION**: This file is a custom addition to the Delta repository. It documents the Adversys Core integration tool that is NOT part of the upstream Delta codebase.

Tool for managing and executing penetration tests in Adversys Core.

## Operations

### create
Create a new penetration test.

**IMPORTANT: Before creating a penetration test, you MUST ask the user the following configuration questions:**

1. **Destructive Operations**: "Are destructive operations allowed? (yes/no) - Operations that may cause data loss or service disruption"
2. **Approval Requirement**: "Should exploits require approval before execution? (yes/no) - This adds a safety check before running potentially risky exploits"
3. **Noise Level**: "What noise level should be used? (silent/low/medium/high) - Controls how detectable the testing activities are"
4. **Test Intensiveness**: "What test intensiveness level? (quick/standard/thorough/exhaustive) - Controls how thorough and comprehensive the testing will be"
5. **Out of Scope Targets**: "Are there any out-of-scope targets that should be excluded? (yes/no) - If yes, please specify which targets (domains, IPs, or ranges) should not be tested"

**After collecting answers, map them to the ROE and scope parameters:**

- `destructive` (ROE): true/false based on destructive operations answer
- `requires_approval` (ROE): true/false based on approval requirement answer
- `noise_level` (ROE): "silent", "low", "medium", or "high" based on noise level answer
- `intensiveness` (ROE): "quick", "standard", "thorough", or "exhaustive" based on test intensiveness answer
- `out_of_scope_targets` (scope): List of target objects with `name`, `value`, and `type` fields. Format: `[{"name": "example.com", "value": "example.com", "type": "domain"}]`
- `verify_out_of_scope` (scope): Automatically set to `true` when out_of_scope_targets are provided

**Parameters:**
- `operation`: "create"
- `name` (required): Name for the penetration test
- `target_id` (optional): UUID of the target to test (if you have the target ID)
- `target` (optional): Target identifier (name or IP address) - the tool will automatically search for and find the matching target
- `target_name` (optional): Target name - the tool will automatically search for and find the matching target by name
- `target_ip` (optional): Target IP address - the tool will automatically search for and find the matching target by IP address
- `test_type` (optional): "black_box" (default) or "white_box"

**IMPORTANT**: You can provide either `target_id` OR one of `target`/`target_name`/`target_ip`. If you provide a target identifier (name or IP), the tool will automatically search for the matching target. For example:
- `target: "192.168.10.10"` will find the target with that IP address
- `target: "GOAD-DC01"` will find the target with that name
- `target_id: "abc-123-def"` will use the target with that ID directly
- `roe` (optional): JSON string with Rules of Engagement:
  ```json
  {
    "destructive": false,
    "requires_approval": true,
    "noise_level": "medium",
    "intensiveness": "standard",
    "time_windows": [],
    "excluded_targets": [],
    "allowed_techniques": []
  }
  ```
- `scope` (optional): JSON string with test scope:
  ```json
  {
    "targets": ["target-id-1", "target-id-2"],
    "included_modules": [],
    "excluded_modules": [],
    "network_segments": [],
    "verify_out_of_scope": true
  }
  ```
  **Note**: The `targets` field is required by the API. The tool will automatically add the `target_id` to this list if not provided. Targets must be an array of strings (target IDs), not objects.

**Examples:**

Using target_id:
```
operation: create
name: "Q1 2024 Security Assessment"
target_id: "abc-123-def"
test_type: "black_box"
roe: {"destructive": false, "requires_approval": true, "noise_level": "medium", "intensiveness": "standard"}
scope: {"verify_out_of_scope": true}
```

Using target IP address (automatically finds matching target):
```
operation: create
name: "Q1 2024 Security Assessment"
target: "192.168.10.10"
test_type: "black_box"
roe: {"destructive": false, "requires_approval": true, "noise_level": "medium", "intensiveness": "standard"}
scope: {"verify_out_of_scope": true}
```

Using target name (automatically finds matching target):
```
operation: create
name: "Q1 2024 Security Assessment"
target: "GOAD-DC01"
test_type: "black_box"
roe: {"destructive": false, "requires_approval": true, "noise_level": "medium", "intensiveness": "standard"}
scope: {"verify_out_of_scope": true}
```

### start
Start execution of a penetration test.

**Parameters:**
- `operation`: "start"
- `test_id` (required): UUID of the test to start

### status
Get current status and progress of a penetration test.

**Parameters:**
- `operation`: "status"
- `test_id` (required): UUID of the test

**Returns:**
- Status (pending, running, paused, completed, failed, cancelled)
- Progress percentage
- Current phase and module
- Modules completed/total
- Exploit approval status (if waiting)

### pause
Pause a running penetration test.

**Parameters:**
- `operation`: "pause"
- `test_id` (required): UUID of the test

### resume
Resume a paused penetration test.

**Parameters:**
- `operation`: "resume"
- `test_id` (required): UUID of the test

### approve_exploit
Approve an exploit execution when test is waiting for approval.

**IMPORTANT: When checking test status and you see a pending exploit approval, you MUST ask the user if they want to approve the exploit before proceeding.**

Ask the user: "The penetration test is waiting for approval to execute an exploit. [Describe the exploit details from the status]. Do you want to approve this exploit? (yes/no)"

**Parameters:**
- `operation`: "approve_exploit"
- `test_id` (required): UUID of the test
- `execution_id` (optional): UUID of the execution requiring approval (if available)

### list
List all penetration tests.

**Parameters:**
- `operation`: "list"
